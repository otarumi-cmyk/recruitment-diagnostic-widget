<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>診断結果 - 想定年収診断</title>
  <style>
    :root {
      --bg: #f8f7f4;
      --panel: #ffffff;
      --border: #e9e5dd;
      --primary: #ff6b03;
      --primary-2: #ffa347;
      --text: #1f2933;
      --muted: #6b7280;
      --radius: 16px;
      --font: 'Inter', 'Noto Sans JP', system-ui, -apple-system, sans-serif;
      --shadow: 0 16px 40px rgba(0,0,0,0.10);
      --shadow-soft: 0 8px 20px rgba(0,0,0,0.06);
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: var(--font);
      background: radial-gradient(circle at 20% 20%, rgba(255,107,3,0.07), transparent 26%),
                  radial-gradient(circle at 80% 0%, rgba(255,163,71,0.08), transparent 22%),
                  var(--bg);
      color: var(--text);
      padding: 24px;
    }
    .shell {
      max-width: 1080px;
      margin: 0 auto;
      display: grid;
      gap: 20px;
    }
    .hero {
      padding: 24px 28px;
      background: linear-gradient(135deg, rgba(255,107,3,0.10), rgba(255,163,71,0.10));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-soft);
    }
    .hero h1 { margin: 0 0 8px; font-size: 24px; letter-spacing: 0.01em; }
    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-soft);
      padding: 20px;
    }
    .speech-bubble-container {
      display: flex;
      align-items: center;
      gap: 16px;
      opacity: 0;
      animation: fadeIn 0.6s ease-out 0.2s forwards;
    }
    .character-img {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border: 2px solid var(--border);
      flex-shrink: 0;
    }
    .speech-bubble {
      position: relative;
      background: #fffaf5;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 8px 14px;
      font-size: clamp(16px, 1.8vw, 20px);
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      flex: 1;
      line-height: 1.5;
      opacity: 0;
      transform: translateY(-10px);
      animation: bubbleFadeIn 0.6s ease-out 0.3s forwards;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 120px;
      box-sizing: border-box;
      text-align: center;
    }
    .speech-bubble::before {
      content: '';
      position: absolute;
      left: -8px;
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      border-right: 8px solid var(--border);
    }
    .speech-bubble::after {
      content: '';
      position: absolute;
      left: -7px;
      top: 50%;
      transform: translateY(-50%);
      width: 0;
      height: 0;
      border-top: 8px solid transparent;
      border-bottom: 8px solid transparent;
      border-right: 8px solid #fffaf5;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes bubbleFadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

    .result-hero { text-align: center; padding: 16px 8px 8px; }
    .salary-display {
      background: linear-gradient(135deg, rgba(255,107,3,0.10), rgba(255,163,71,0.10));
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 32px 20px;
      margin: 24px 0 16px;
      box-shadow: var(--shadow-soft);
    }
    .salary-amount {
      font-size: 56px;
      font-weight: 800;
      color: var(--primary);
      margin: 8px 0 4px;
      line-height: 1;
    }
    .salary-label { font-size: 16px; color: var(--muted); }

    .comparison {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: #fffaf5;
      border-radius: 12px;
      margin: 12px 0 8px;
    }
    .comparison-item { text-align: center; flex: 1; }
    .comparison-label { font-size: 13px; color: var(--muted); margin-bottom: 4px; }
    .comparison-value { font-size: 22px; font-weight: 700; }
    .comparison-value.current { color: var(--text); }
    .comparison-value.increase { color: #22c55e; }
    .divider { width: 1px; height: 40px; background: var(--border); }

    .summary-text { margin-top: 16px; font-size: 14px; color: var(--text); line-height: 1.8; }
    .summary-text strong { font-weight: 700; }

    .hint-box {
      margin-top: 20px;
      padding: 16px;
      background: #ffffff;
      border-radius: 12px;
      border: 1px solid var(--border);
    }
    .hint-title { font-size: 14px; font-weight: 700; margin-bottom: 8px; color: var(--primary); }
    .hint-list { margin: 0; padding-left: 18px; font-size: 13px; color: var(--muted); }

    .sim-block {
      margin-top: 24px;
      padding: 16px;
      background: #fffaf5;
      border-radius: 12px;
      border: 1px solid var(--border);
    }
    .sim-title {
      margin: 0 0 6px;
      font-size: 15px;
      font-weight: 700;
      color: var(--text);
    }
    .sim-caption {
      margin: 0 0 12px;
      font-size: 12px;
      color: var(--muted);
    }
    .sim-cards {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 12px;
    }
    .sim-card {
      flex: 1 1 140px;
      padding: 10px 12px;
      border-radius: 10px;
      background: #ffffff;
      border: 1px solid var(--border);
      box-shadow: 0 4px 10px rgba(0,0,0,0.03);
    }
    .sim-card.highlight {
      background: linear-gradient(135deg, rgba(249,115,22,0.10), rgba(251,146,60,0.10));
      border-color: rgba(249,115,22,0.35);
    }
    .sim-card-label {
      font-size: 11px;
      color: var(--muted);
      margin-bottom: 4px;
    }
    .sim-card-value {
      font-size: 16px;
      font-weight: 700;
      color: var(--text);
    }
    .sim-card.highlight .sim-card-value {
      color: #f97316;
      font-size: 17px;
    }
    .sim-card-sub {
      margin-top: 2px;
      font-size: 11px;
      color: var(--muted);
    }
    .sim-chart {
      width: 100%;
      max-width: 520px;
      margin: 0 auto;
      position: relative;
    }
    .sim-legend {
      display: flex;
      justify-content: center;
      gap: 16px;
      margin-top: 8px;
      font-size: 12px;
      color: var(--muted);
    }
    .sim-legend-item {
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .sim-legend-color {
      width: 14px;
      height: 3px;
      border-radius: 999px;
    }
    .sim-summary {
      margin-top: 12px;
      font-size: 13px;
      color: var(--text);
      line-height: 1.7;
    }
    .sim-tooltip {
      position: absolute;
      padding: 10px 14px;
      border-radius: 8px;
      background: #111827;
      color: #f9fafb;
      font-size: 13px;
      line-height: 1.6;
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      pointer-events: none;
      white-space: nowrap;
      z-index: 5;
      left: 50%;
      top: 0;
      transform: translate(-50%, -115%);
      display: none;
    }
    .sim-tooltip-main {
      font-size: 15px;
      font-weight: 700;
      margin-bottom: 4px;
      display: block;
    }
    .sim-tooltip-sub {
      font-size: 12px;
      opacity: 0.9;
    }

    .btn {
      border: none;
      border-radius: 12px;
      padding: 12px 16px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s ease;
      text-decoration: none;
      display: inline-block;
      font-size: 14px;
    }
    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-2));
      color: #fff;
      box-shadow: 0 10px 24px rgba(255,107,3,0.26);
    }
    .btn-primary:hover { filter: brightness(1.05); transform: translateY(-1px); }

    @media (max-width: 640px) {
      body { padding: 16px; }
      .hero { padding: 18px; }
      .speech-bubble-container { flex-direction: column; align-items: center; }
      .character-img {
        width: 80px;
        height: 80px;
      }
      .speech-bubble {
        width: 100%;
        font-size: clamp(15px, 4vw, 18px);
        min-height: 80px;
        padding: 6px 10px;
      }
      .speech-bubble::before {
        left: 50%;
        top: -8px;
        transform: translateX(-50%);
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-bottom: 8px solid var(--border);
        border-top: none;
        border-right: none;
      }
      .speech-bubble::after {
        left: 50%;
        top: -7px;
        transform: translateX(-50%);
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-bottom: 8px solid #fffaf5;
        border-top: none;
        border-right: none;
      }
      .salary-amount { font-size: 42px; }
      .comparison { flex-direction: column; gap: 12px; }
      .divider { width: 100%; height: 1px; }
      .sim-chart {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="hero">
      <h1>想定年収診断の結果</h1>
    </div>

    <div class="hero">
      <div class="speech-bubble-container">
        <img src="images/character.png" alt="キャラクター" class="character-img">
        <div class="speech-bubble" id="speech-text">
          あなたの想定年収を計算しました。
        </div>
      </div>
    </div>

    <div class="panel" id="result-root">
      <div class="result-hero">
        <div class="salary-display">
          <div style="font-size:14px; color:var(--muted);">現年収をもとにした目安値</div>
          <div class="salary-amount" id="estimated-salary">-</div>
          <div class="salary-label">想定年収（額面・税込／万円）</div>
        </div>

        <div class="comparison">
          <div class="comparison-item">
            <div class="comparison-label">現在の年収（自己申告）</div>
            <div class="comparison-value current" id="base-income">-</div>
          </div>
          <div class="divider"></div>
          <div class="comparison-item">
            <div class="comparison-label">今回の診断による上乗せ分</div>
            <div class="comparison-value increase" id="add-amount">-</div>
          </div>
        </div>

        <div class="summary-text" id="summary-text"></div>

        <div class="hint-box" id="hint-box">
          <div class="hint-title">さらに年収アップを狙うためのヒント</div>
          <ul class="hint-list" id="hint-list"></ul>
        </div>

        <div class="sim-block">
          <p class="sim-title">転職した場合／しなかった場合の「30年分の年収推移」比較</p>
          <p class="sim-caption">※ 今の年収と今回の想定年収をもとに、30年間の「各年の年収」を転職あり・なしで並べて比較しています。</p>

          <div class="sim-cards">
            <div class="sim-card">
              <div class="sim-card-label">転職しない場合の30年間の合計年収（概算）</div>
              <div class="sim-card-value" id="lifetime-no">-</div>
              <div class="sim-card-sub">今の会社で昇給し続けた場合</div>
            </div>
            <div class="sim-card">
              <div class="sim-card-label">転職した場合の30年間の合計年収（概算）</div>
              <div class="sim-card-value" id="lifetime-with">-</div>
              <div class="sim-card-sub">今回の想定年収レベルのポジションに移った場合</div>
            </div>
            <div class="sim-card highlight">
              <div class="sim-card-label">生涯で増える見込みの金額（差額）</div>
              <div class="sim-card-value" id="lifetime-diff">-</div>
              <div class="sim-card-sub">転職しない場合と比べたときのプラス分</div>
            </div>
          </div>

          <div id="sim-chart" class="sim-chart"></div>
          <div id="sim-tooltip" class="sim-tooltip"></div>
          <div class="sim-legend">
            <div class="sim-legend-item">
              <span class="sim-legend-color" style="background:#cbd5f5;"></span>
              <span>転職しない場合の年収</span>
            </div>
            <div class="sim-legend-item">
              <span class="sim-legend-color" style="background:#f97316;"></span>
              <span>転職した場合の年収</span>
            </div>
          </div>
          <p id="sim-summary" class="sim-summary"></p>
        </div>

        <div style="margin-top: 28px; text-align: center;">
          <a href="salary-estimation.html" class="btn btn-primary">もう一度診断する</a>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    function loadResult() {
      const params = new URLSearchParams(window.location.search);
      const encoded = params.get('data');
      if (encoded) {
        try {
          const json = decodeURIComponent(atob(encoded));
          return JSON.parse(json);
        } catch (e) {
          console.error('URLからの復元に失敗:', e);
        }
      }
      const stored = localStorage.getItem('salaryEstimationResult');
      if (!stored) return null;
      try {
        return JSON.parse(stored);
      } catch (e) {
        console.error('localStorageからの復元に失敗:', e);
        return null;
      }
    }

    function formatMan(value) {
      if (!isFinite(value)) return '-';
      const v = Math.round(value);
      return v.toLocaleString('ja-JP') + '万円';
    }

    function buildComment(score, baseIncome, addAmount) {
      const rateUp = baseIncome > 0 ? Math.round((addAmount / baseIncome) * 100) : null;
      let level;
      if (score >= 45) level = 'high';
      else if (score >= 30) level = 'mid';
      else level = 'low';

      let main = '';
      if (level === 'high') {
        main = '現在のスキル・役職・実績から見ると、比較的高めの年収レンジを狙えるポジションです。';
      } else if (level === 'mid') {
        main = '現状のスキルと実績に見合った、堅実な年収アップが期待できる水準です。';
      } else {
        main = 'いまの条件でも年収アップの余地はありますが、あと一歩スキルや役割を伸ばせると、さらに上のレンジを狙えそうです。';
      }

      let up = '';
      if (rateUp != null) {
        up = `今回の診断では、<strong>現年収に対して約${rateUp}%の上振れ</strong>を見込める想定になりました。`;
      } else {
        up = '今回の診断では、現年収に対して一定の上振れが見込める想定になりました。';
      }

      return `${main}<br>${up}`;
    }

    function buildHints(score) {
      const hints = [];
      if (score < 30) {
        hints.push('担当領域を広げる（プロジェクト参画や新しい業務を任せてもらう）ことで評価軸を増やす。');
        hints.push('数値で語れる実績（売上・利益・コスト削減など）を1つでも作り、説明できるようにしておく。');
        hints.push('デジタルスキルや資格取得など、客観的に示しやすい強みを1つ追加する。');
      } else if (score < 45) {
        hints.push('今の強みを活かせる業界・職種に寄せていくと、同じスキルでも年収レンジが上がりやすくなります。');
        hints.push('マネジメントやプロジェクトリードの経験を明確にしておくと、年収テーブルの一段上が見えやすくなります。');
        hints.push('直近1〜2年で「もう1つ数字で語れる成果」を作れると、交渉余地が広がります。');
      } else {
        // 高スコア帯では追加のヒント文は表示しない
      }
      return hints;
    }

    function buildSimulation(baseIncome, estimated) {
      const years = 30; // 今から30年分をざっくり比較
      const growthCurrent = 0.02;  // 転職しない場合の年収成長率（年2%想定）
      const growthSwitch = 0.036;  // 転職した場合の年収成長率（年3.6%想定）

      const noChange = [];
      const withChange = [];

      for (let i = 0; i < years; i++) {
        if (i === 0) {
          noChange[i] = baseIncome;
          withChange[i] = estimated;
        } else {
          noChange[i] = noChange[i - 1] * (1 + growthCurrent);
          withChange[i] = withChange[i - 1] * (1 + growthSwitch);
        }
      }

      const sumNo = noChange.reduce((a, b) => a + b, 0);
      const sumWith = withChange.reduce((a, b) => a + b, 0);
      return { years, noChange, withChange, sumNo, sumWith };
    }

    function renderSimulation(sim) {
      const chartEl = document.getElementById('sim-chart');
      const summaryEl = document.getElementById('sim-summary');
      if (!chartEl || !summaryEl) return;

      const { years, noChange, withChange, sumNo, sumWith } = sim;
      const maxIncome = Math.max(...noChange, ...withChange);
      if (maxIncome <= 0) {
        chartEl.innerHTML = '<p style="font-size:12px; color:var(--muted); text-align:center;">年収が未入力のため、シミュレーションは表示していません。</p>';
        summaryEl.textContent = '';
        return;
      }

      // カード用の表示
      const lifeNoEl = document.getElementById('lifetime-no');
      const lifeWithEl = document.getElementById('lifetime-with');
      const lifeDiffEl = document.getElementById('lifetime-diff');
      if (lifeNoEl) lifeNoEl.textContent = formatMan(sumNo);
      if (lifeWithEl) lifeWithEl.textContent = formatMan(sumWith);

      const diff = sumWith - sumNo; // 万円単位
      if (lifeDiffEl) {
        const diffAbs = Math.abs(Math.round(diff));
        lifeDiffEl.textContent = (diff >= 0 ? '+' : '±') + diffAbs.toLocaleString('ja-JP') + '万円';
      }

      // 30年分の年収を棒グラフ（2本組×30）で表示
      const width = 380;
      const height = 230;
      const marginLeft = 50;   // 左余白は元のバランスに戻す
      const marginRight = 16;
      const marginTop = 18;
      const marginBottom = 48;

      const plotHeight = height - marginTop - marginBottom;
      const axisY = marginTop + plotHeight; // X軸（0ライン）
      const barMaxHeight = plotHeight * 0.9;
      const scale = barMaxHeight / maxIncome;

      const barAreaWidth = width - marginLeft - marginRight;
      const groupWidth = barAreaWidth / years;
      const singleBarWidth = Math.max(3, Math.min(8, groupWidth * 0.4));
      const innerGap = Math.max(2, groupWidth * 0.1);

      const xForA = (i) => marginLeft + i * groupWidth + (groupWidth - (2 * singleBarWidth + innerGap)) / 2;
      const xForB = (i) => xForA(i) + singleBarWidth + innerGap;

      // Y軸ラベル（0 / 中間 / 最大）
      const yMax = maxIncome;
      const yMid = maxIncome * 0.5;
      const yMin = 0;

      const svg = `
        <svg viewBox="0 0 ${width} ${height}" width="100%" height="${height}" role="img" aria-label="年収シミュレーション">
          <!-- 軸 -->
          <line x1="${marginLeft}" y1="${marginTop}" x2="${marginLeft}" y2="${axisY}" stroke="#e5e7eb" stroke-width="1" />
          <line x1="${marginLeft}" y1="${axisY}" x2="${width - marginRight}" y2="${axisY}" stroke="#e5e7eb" stroke-width="1" />

          <!-- Y軸ラベル（年収：万円） -->
          <text x="${marginLeft - 2}" y="${axisY + 4}" text-anchor="end" font-size="10" fill="#6b7280">
            ${Math.round(yMin).toLocaleString('ja-JP')}
          </text>
          <text x="${marginLeft - 2}" y="${axisY - (yMid * scale) + 4}" text-anchor="end" font-size="10" fill="#6b7280">
            ${Math.round(yMid).toLocaleString('ja-JP')}
          </text>
          <text x="${marginLeft - 2}" y="${axisY - (yMax * scale) + 4}" text-anchor="end" font-size="10" fill="#6b7280">
            ${Math.round(yMax).toLocaleString('ja-JP')}
          </text>
          <text x="${marginLeft + 18}" y="${marginTop - 2}" text-anchor="end" font-size="10" fill="#9ca3af">年収（万円）</text>

          <!-- 30年分の棒グラフ（グレー：転職しない／オレンジ：転職する） -->
          ${noChange.map((aVal, i) => {
            const bVal = withChange[i];
            const xA = xForA(i);
            const xB = xForB(i);
            const hA = aVal * scale;
            const hB = bVal * scale;
            const yA = axisY - hA;
            const yB = axisY - hB;
            const diffYear = bVal - aVal;
            return `
              <g>
                <rect x="${xA}" y="${yA}" width="${singleBarWidth}" height="${hA}" fill="#9ca3af"
                  data-year="${i}"
                  data-type="no"
                  data-a="${aVal}"
                  data-b="${bVal}"
                  data-diff="${diffYear}"
                />
                <rect x="${xB}" y="${yB}" width="${singleBarWidth}" height="${hB}" fill="#f97316"
                  data-year="${i}"
                  data-type="with"
                  data-a="${aVal}"
                  data-b="${bVal}"
                  data-diff="${diffYear}"
                />
              </g>
            `;
          }).join('')}

          <!-- X軸ラベル（今／+10年／+20年／+30年） -->
          ${[0, 9, 19, years - 1].map(i => `
            <text x="${xForB(i) + singleBarWidth / 2}" y="${height - marginBottom + 12}" text-anchor="middle" font-size="10" fill="#6b7280">
              ${i === 0 ? '今' : '+' + i + '年'}
            </text>
          `).join('')}
        </svg>
      `;

      chartEl.innerHTML = svg;

      if (diff > 0) {
        const diffRounded = Math.round(diff);
        const diffText = diffRounded.toLocaleString('ja-JP');
        summaryEl.innerHTML = `今後30年間の合計年収で見ると、<strong>転職しない場合と比べて約${diffText}万円分の差</strong>がつく試算です。<br>つまり、いまのまま動かない場合は、この金額分のチャンスを逃してしまう可能性があります。`;
      } else {
        summaryEl.textContent = '今回の入力条件では、転職の有無による長期的な年収差はほとんどありません。条件やタイミングを変えて再診断してみるのもおすすめです。';
      }

      // カスタムツールチップ（PCホバー／スマホタップ対応）
      const svgEl = chartEl.querySelector('svg');
      const tooltipEl = document.getElementById('sim-tooltip');
      if (!svgEl || !tooltipEl) return;

      function formatYearLabel(i) {
        if (i === 0) return '今（1年目）';
        return `${i}年目（いまから${i}年後）`;
      }

      function formatYen(v) {
        return `${Math.round(v).toLocaleString('ja-JP')}万円`;
      }

      function showTooltip(evt, rect) {
        const yearIndex = Number(rect.getAttribute('data-year')) || 0;
        const aVal = Number(rect.getAttribute('data-a')) || 0;
        const bVal = Number(rect.getAttribute('data-b')) || 0;
        const diffVal = Number(rect.getAttribute('data-diff')) || 0;

        const yearText = formatYearLabel(yearIndex);
        const diffSign = diffVal >= 0 ? '+' : '';

        tooltipEl.innerHTML = `
          <span class="sim-tooltip-main">差額：${diffSign}${formatYen(diffVal)}</span>
          <div class="sim-tooltip-sub">
            <div>${yearText}</div>
            <div>転職しない場合：${formatYen(aVal)}</div>
            <div>転職した場合：${formatYen(bVal)}</div>
          </div>
        `;

        tooltipEl.style.display = 'block';
      }

      function hideTooltip() {
        tooltipEl.style.display = 'none';
      }

      svgEl.querySelectorAll('rect[data-year]').forEach(rect => {
        rect.addEventListener('mouseenter', (e) => showTooltip(e, rect));
        rect.addEventListener('mousemove', (e) => showTooltip(e, rect));
        rect.addEventListener('mouseleave', hideTooltip);
        rect.addEventListener('click', (e) => showTooltip(e, rect));
      });
    }

    const payload = loadResult();
    if (!payload) {
      document.getElementById('result-root').innerHTML = `
        <div class="question-card">
          <p>診断結果が見つかりませんでした。はじめから診断をやり直してください。</p>
          <p style="margin-top:16px;"><a href="salary-estimation.html" class="btn btn-primary">診断を開始する</a></p>
        </div>
      `;
    } else {
      const { baseIncome, addAmount, estimated, score } = payload;
      const estimatedEl = document.getElementById('estimated-salary');
      const baseEl = document.getElementById('base-income');
      const addEl = document.getElementById('add-amount');
      const summaryEl = document.getElementById('summary-text');
      const hintListEl = document.getElementById('hint-list');
      const hintBoxEl = document.getElementById('hint-box');
      const speechEl = document.getElementById('speech-text');

      estimatedEl.textContent = formatMan(estimated);
      baseEl.textContent = formatMan(baseIncome);
      addEl.textContent = `+${formatMan(addAmount).replace('万円', '')}万円`;

      summaryEl.innerHTML = buildComment(score, baseIncome, addAmount);

      const hints = buildHints(score);
      if (hints.length === 0) {
        if (hintBoxEl) hintBoxEl.style.display = 'none';
      } else {
        hintListEl.innerHTML = hints.map(h => `<li>${h}</li>`).join('');
      }

      if (score >= 45) {
        speechEl.textContent = 'かなりいいポジションにいます。このまま強みを活かして、想定年収の中身をチェックしてみましょう。';
      } else if (score >= 30) {
        speechEl.textContent = '着実に年収アップを狙える状態です。今回の結果で「どこを伸ばすと効きやすいか」を一緒に見ていきましょう。';
      } else {
        speechEl.textContent = 'ここから年収を伸ばしていく余地がたくさんあります。伸びしろのポイントを一緒に整理していきましょう。';
      }

      // 転職あり／なしの年収シミュレーションを描画
      const sim = buildSimulation(baseIncome, estimated);
      renderSimulation(sim);
    }
  </script>
</body>
</html>

